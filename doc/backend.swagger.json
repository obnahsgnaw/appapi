{
  "swagger": "2.0",
  "info": {
    "title": "Backend API",
    "description": "The backend api",
    "version": "1.0",
    "contact": {
      "name": "efly",
      "url": "https://efly-cetc.com",
      "email": "none@example.com"
    }
  },
  "tags": [
    {
      "name": "IndexService",
      "description": "默认"
    },
    {
      "name": "OptionsService",
      "description": "选项管理"
    },
    {
      "name": "AttrConfigService",
      "description": "属性配置管理"
    },
    {
      "name": "ConfigService",
      "description": "动态配置"
    }
  ],
  "schemes": [
    "http",
    "https"
  ],
  "consumes": [
    "application/json",
    "application/octet-stream"
  ],
  "produces": [
    "application/json",
    "application/octet-stream"
  ],
  "paths": {
    "/v1/attr-configs": {
      "get": {
        "summary": "列表",
        "description": "展示所有或分页的属性配置",
        "operationId": "AttrConfigService_Paginate",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1AttrConfigPaginateResponse"
            }
          },
          "201": {
            "description": "Returned when the resource created success.",
            "schema": {}
          },
          "204": {
            "description": "Returned when the resource deleted success.",
            "schema": {}
          },
          "400": {
            "description": "Returned when the request data validate failed.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          },
          "401": {
            "description": "Returned when the user does not authentication.",
            "schema": {}
          },
          "403": {
            "description": "Returned when the user does not have permission to access the resource.",
            "schema": {}
          },
          "404": {
            "description": "Returned when the resource not found.",
            "schema": {}
          },
          "409": {
            "description": "Returned when request update conflict.",
            "schema": {}
          },
          "423": {
            "description": "Returned when resource locked.",
            "schema": {}
          },
          "429": {
            "description": "Returned when request too many in a unit time.",
            "schema": {}
          },
          "500": {
            "description": "Server error.",
            "schema": {}
          },
          "default": {
            "description": "Unexpect error.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          }
        },
        "parameters": [
          {
            "name": "all",
            "description": "All resource records, no paginate if support",
            "in": "query",
            "required": false,
            "type": "boolean"
          },
          {
            "name": "page",
            "description": "Page number, default=1",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "limit",
            "description": "Page size, default=10",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int64"
          },
          {
            "name": "keyword",
            "description": "Keyword search, like:keyword=xx，keyword=id=1|name=xxx",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "sort",
            "description": "Sort list, like: sort=+a,-b,+c,-d",
            "in": "query",
            "required": false,
            "type": "string"
          }
        ],
        "tags": [
          "AttrConfigService"
        ],
        "security": [
          {
            "AppId": [],
            "BearerToken": []
          }
        ],
        "x-order": 1
      },
      "delete": {
        "summary": "删除",
        "operationId": "AttrConfigService_Delete",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "201": {
            "description": "Returned when the resource created success.",
            "schema": {}
          },
          "204": {
            "description": "Returned when the resource deleted success.",
            "schema": {}
          },
          "400": {
            "description": "Returned when the request data validate failed.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          },
          "401": {
            "description": "Returned when the user does not authentication.",
            "schema": {}
          },
          "403": {
            "description": "Returned when the user does not have permission to access the resource.",
            "schema": {}
          },
          "404": {
            "description": "Returned when the resource not found.",
            "schema": {}
          },
          "409": {
            "description": "Returned when request update conflict.",
            "schema": {}
          },
          "423": {
            "description": "Returned when resource locked.",
            "schema": {}
          },
          "429": {
            "description": "Returned when request too many in a unit time.",
            "schema": {}
          },
          "500": {
            "description": "Server error.",
            "schema": {}
          },
          "default": {
            "description": "Unexpect error.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          }
        },
        "parameters": [
          {
            "name": "attr",
            "description": "attr",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "title",
            "description": "标题",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "kind",
            "description": "数据类型",
            "in": "query",
            "required": false,
            "type": "string",
            "enum": [
              "ExtAttrKindNone",
              "ExtAttrKindText",
              "ExtAttrKindInt",
              "ExtAttrKindFloat",
              "ExtAttrKindBool",
              "ExtAttrKindOption",
              "ExtAttrKindDatetime",
              "ExtAttrKindDate",
              "ExtAttrKindTime"
            ],
            "default": "ExtAttrKindNone"
          },
          {
            "name": "value",
            "description": "默认值",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "options",
            "description": "Kind=option时的可选项",
            "in": "query",
            "required": false,
            "type": "array",
            "items": {
              "type": "string"
            },
            "collectionFormat": "multi"
          },
          {
            "name": "conflict.value",
            "description": "Value\n\nThe conflict value of the resource",
            "in": "query",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "AttrConfigService"
        ],
        "security": [
          {
            "AppId": [],
            "BearerToken": []
          }
        ],
        "x-order": 1
      },
      "post": {
        "summary": "刷新",
        "description": "有则更新无则创建",
        "operationId": "AttrConfigService_Refresh",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1AttrConfigData"
            }
          },
          "201": {
            "description": "Returned when the resource created success.",
            "schema": {}
          },
          "204": {
            "description": "Returned when the resource deleted success.",
            "schema": {}
          },
          "400": {
            "description": "Returned when the request data validate failed.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          },
          "401": {
            "description": "Returned when the user does not authentication.",
            "schema": {}
          },
          "403": {
            "description": "Returned when the user does not have permission to access the resource.",
            "schema": {}
          },
          "404": {
            "description": "Returned when the resource not found.",
            "schema": {}
          },
          "409": {
            "description": "Returned when request update conflict.",
            "schema": {}
          },
          "423": {
            "description": "Returned when resource locked.",
            "schema": {}
          },
          "429": {
            "description": "Returned when request too many in a unit time.",
            "schema": {}
          },
          "500": {
            "description": "Server error.",
            "schema": {}
          },
          "default": {
            "description": "Unexpect error.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/v1AttrConfig"
            }
          }
        ],
        "tags": [
          "AttrConfigService"
        ],
        "security": [
          {
            "AppId": [],
            "BearerToken": []
          }
        ],
        "x-order": 2
      }
    },
    "/v1/attr-configs/disable-state": {
      "put": {
        "summary": "禁用",
        "description": "禁用",
        "operationId": "AttrConfigService_Disable",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1AttrConfigData"
            }
          },
          "201": {
            "description": "Returned when the resource created success.",
            "schema": {}
          },
          "204": {
            "description": "Returned when the resource deleted success.",
            "schema": {}
          },
          "400": {
            "description": "Returned when the request data validate failed.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          },
          "401": {
            "description": "Returned when the user does not authentication.",
            "schema": {}
          },
          "403": {
            "description": "Returned when the user does not have permission to access the resource.",
            "schema": {}
          },
          "404": {
            "description": "Returned when the resource not found.",
            "schema": {}
          },
          "409": {
            "description": "Returned when request update conflict.",
            "schema": {}
          },
          "423": {
            "description": "Returned when resource locked.",
            "schema": {}
          },
          "429": {
            "description": "Returned when request too many in a unit time.",
            "schema": {}
          },
          "500": {
            "description": "Server error.",
            "schema": {}
          },
          "default": {
            "description": "Unexpect error.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/v1AttrConfig"
            }
          }
        ],
        "tags": [
          "AttrConfigService"
        ],
        "security": [
          {
            "AppId": [],
            "BearerToken": []
          }
        ],
        "x-order": 4
      }
    },
    "/v1/attr-configs/enable-state": {
      "put": {
        "summary": "启用",
        "description": "启用",
        "operationId": "AttrConfigService_Enable",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1AttrConfigData"
            }
          },
          "201": {
            "description": "Returned when the resource created success.",
            "schema": {}
          },
          "204": {
            "description": "Returned when the resource deleted success.",
            "schema": {}
          },
          "400": {
            "description": "Returned when the request data validate failed.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          },
          "401": {
            "description": "Returned when the user does not authentication.",
            "schema": {}
          },
          "403": {
            "description": "Returned when the user does not have permission to access the resource.",
            "schema": {}
          },
          "404": {
            "description": "Returned when the resource not found.",
            "schema": {}
          },
          "409": {
            "description": "Returned when request update conflict.",
            "schema": {}
          },
          "423": {
            "description": "Returned when resource locked.",
            "schema": {}
          },
          "429": {
            "description": "Returned when request too many in a unit time.",
            "schema": {}
          },
          "500": {
            "description": "Server error.",
            "schema": {}
          },
          "default": {
            "description": "Unexpect error.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/v1AttrConfig"
            }
          }
        ],
        "tags": [
          "AttrConfigService"
        ],
        "security": [
          {
            "AppId": [],
            "BearerToken": []
          }
        ],
        "x-order": 3
      }
    },
    "/v1/config": {
      "get": {
        "summary": "配置信息",
        "description": "返回服务当前配置信息",
        "operationId": "ConfigService_Detail",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1Config"
            }
          },
          "201": {
            "description": "Returned when the resource created success.",
            "schema": {}
          },
          "204": {
            "description": "Returned when the resource deleted success.",
            "schema": {}
          },
          "400": {
            "description": "Returned when the request data validate failed.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          },
          "401": {
            "description": "Returned when the user does not authentication.",
            "schema": {}
          },
          "403": {
            "description": "Returned when the user does not have permission to access the resource.",
            "schema": {}
          },
          "404": {
            "description": "Returned when the resource not found.",
            "schema": {}
          },
          "409": {
            "description": "Returned when request update conflict.",
            "schema": {}
          },
          "423": {
            "description": "Returned when resource locked.",
            "schema": {}
          },
          "429": {
            "description": "Returned when request too many in a unit time.",
            "schema": {}
          },
          "500": {
            "description": "Server error.",
            "schema": {}
          },
          "default": {
            "description": "Unexpect error.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          }
        },
        "tags": [
          "ConfigService"
        ],
        "security": [
          {
            "AppId": [],
            "BearerToken": []
          }
        ]
      },
      "put": {
        "summary": "更新配置",
        "description": "更新服务当前配置信息",
        "operationId": "ConfigService_Update",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1Config"
            }
          },
          "201": {
            "description": "Returned when the resource created success.",
            "schema": {}
          },
          "204": {
            "description": "Returned when the resource deleted success.",
            "schema": {}
          },
          "400": {
            "description": "Returned when the request data validate failed.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          },
          "401": {
            "description": "Returned when the user does not authentication.",
            "schema": {}
          },
          "403": {
            "description": "Returned when the user does not have permission to access the resource.",
            "schema": {}
          },
          "404": {
            "description": "Returned when the resource not found.",
            "schema": {}
          },
          "409": {
            "description": "Returned when request update conflict.",
            "schema": {}
          },
          "423": {
            "description": "Returned when resource locked.",
            "schema": {}
          },
          "429": {
            "description": "Returned when request too many in a unit time.",
            "schema": {}
          },
          "500": {
            "description": "Server error.",
            "schema": {}
          },
          "default": {
            "description": "Unexpect error.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          }
        },
        "parameters": [
          {
            "name": "debug",
            "description": "调试模式",
            "in": "query",
            "required": false,
            "type": "boolean"
          }
        ],
        "tags": [
          "ConfigService"
        ],
        "security": [
          {
            "AppId": [],
            "BearerToken": []
          }
        ]
      }
    },
    "/v1/options": {
      "get": {
        "summary": "选项",
        "operationId": "OptionsService_OptionList",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1OptionListResponse"
            }
          },
          "201": {
            "description": "Returned when the resource created success.",
            "schema": {}
          },
          "204": {
            "description": "Returned when the resource deleted success.",
            "schema": {}
          },
          "400": {
            "description": "Returned when the request data validate failed.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          },
          "401": {
            "description": "Returned when the user does not authentication.",
            "schema": {}
          },
          "403": {
            "description": "Returned when the user does not have permission to access the resource.",
            "schema": {}
          },
          "404": {
            "description": "Returned when the resource not found.",
            "schema": {}
          },
          "409": {
            "description": "Returned when request update conflict.",
            "schema": {}
          },
          "423": {
            "description": "Returned when resource locked.",
            "schema": {}
          },
          "429": {
            "description": "Returned when request too many in a unit time.",
            "schema": {}
          },
          "500": {
            "description": "Server error.",
            "schema": {}
          },
          "default": {
            "description": "Unexpect error.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          }
        },
        "tags": [
          "OptionsService"
        ],
        "security": [
          {
            "AppId": []
          }
        ],
        "x-order": 1
      }
    },
    "/v1/version": {
      "get": {
        "summary": "版本号",
        "description": "返回服务当前版本号",
        "operationId": "IndexService_Version",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1VersionResponse"
            }
          },
          "201": {
            "description": "Returned when the resource created success.",
            "schema": {}
          },
          "204": {
            "description": "Returned when the resource deleted success.",
            "schema": {}
          },
          "400": {
            "description": "Returned when the request data validate failed.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          },
          "401": {
            "description": "Returned when the user does not authentication.",
            "schema": {}
          },
          "403": {
            "description": "Returned when the user does not have permission to access the resource.",
            "schema": {}
          },
          "404": {
            "description": "Returned when the resource not found.",
            "schema": {}
          },
          "409": {
            "description": "Returned when request update conflict.",
            "schema": {}
          },
          "423": {
            "description": "Returned when resource locked.",
            "schema": {}
          },
          "429": {
            "description": "Returned when request too many in a unit time.",
            "schema": {}
          },
          "500": {
            "description": "Server error.",
            "schema": {}
          },
          "default": {
            "description": "Unexpect error.",
            "schema": {
              "$ref": "#/definitions/v1ErrorsObject"
            }
          }
        },
        "tags": [
          "IndexService"
        ],
        "security": [
          {
            "AppId": []
          }
        ]
      }
    }
  },
  "definitions": {
    "AttrConfigKind": {
      "type": "string",
      "enum": [
        "ExtAttrKindNone",
        "ExtAttrKindText",
        "ExtAttrKindInt",
        "ExtAttrKindFloat",
        "ExtAttrKindBool",
        "ExtAttrKindOption",
        "ExtAttrKindDatetime",
        "ExtAttrKindDate",
        "ExtAttrKindTime"
      ],
      "default": "ExtAttrKindNone"
    },
    "v1AttrConfig": {
      "type": "object",
      "properties": {
        "attr": {
          "type": "string",
          "description": "attr"
        },
        "title": {
          "type": "string",
          "description": "标题"
        },
        "kind": {
          "$ref": "#/definitions/AttrConfigKind",
          "description": "数据类型"
        },
        "value": {
          "type": "string",
          "description": "默认值"
        },
        "options": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Kind=option时的可选项"
        },
        "conflict": {
          "$ref": "#/definitions/v1Conflict",
          "description": "更新冲突检测数据 更新数据时必须"
        }
      },
      "title": "属性配置",
      "required": [
        "conflict"
      ]
    },
    "v1AttrConfigData": {
      "type": "object",
      "properties": {
        "config": {
          "$ref": "#/definitions/v1AttrConfig",
          "description": "属性配置"
        },
        "enabled": {
          "$ref": "#/definitions/v1EnableState"
        },
        "operateInfo": {
          "$ref": "#/definitions/v1OperateInfo"
        }
      },
      "title": "属性配置数据"
    },
    "v1AttrConfigPaginateResponse": {
      "type": "object",
      "properties": {
        "meta": {
          "$ref": "#/definitions/v1PaginateMeta"
        },
        "list": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1AttrConfigData"
          }
        }
      },
      "title": "属性配置响应"
    },
    "v1Config": {
      "type": "object",
      "properties": {
        "debug": {
          "type": "boolean",
          "description": "调试模式"
        }
      },
      "title": "TODO 8 change  to  project config and controller"
    },
    "v1Conflict": {
      "type": "object",
      "properties": {
        "value": {
          "type": "string",
          "description": "The conflict value of the resource",
          "title": "Value"
        }
      },
      "title": "冲突检查值",
      "required": [
        "value"
      ]
    },
    "v1EnableState": {
      "type": "string",
      "enum": [
        "Disabled",
        "Enabled",
        "Default"
      ],
      "default": "Disabled",
      "title": "启用 禁用"
    },
    "v1ErrorObject": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int64",
          "description": "Response error code",
          "pattern": "^[0-9]{1,}$"
        },
        "message": {
          "type": "string",
          "description": "Response error message"
        }
      },
      "title": "错误"
    },
    "v1ErrorsObject": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int64",
          "description": "Response error code",
          "pattern": "^[0-9]{1,}$"
        },
        "message": {
          "type": "string",
          "description": "Response error message"
        },
        "errors": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1ErrorObject"
          },
          "description": "Response errors",
          "title": "错误链"
        }
      },
      "title": "错误 多个错误"
    },
    "v1IntOption": {
      "type": "object",
      "properties": {
        "id": {
          "type": "integer",
          "format": "int32",
          "description": "ID"
        },
        "name": {
          "type": "string",
          "description": "名称"
        }
      },
      "title": "id name 响应"
    },
    "v1OperateInfo": {
      "type": "object",
      "properties": {
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "创建时间"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time",
          "description": "最后更新时间"
        },
        "deletedAt": {
          "type": "string",
          "format": "date-time",
          "description": "删除时间"
        }
      },
      "title": "操作信息"
    },
    "v1OptionListResponse": {
      "type": "object",
      "properties": {
        "enableState": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/v1IntOption"
          },
          "description": "启禁用状态"
        }
      }
    },
    "v1PaginateMeta": {
      "type": "object",
      "properties": {
        "total": {
          "type": "integer",
          "format": "int64",
          "description": "Resource total nums"
        },
        "page": {
          "type": "integer",
          "format": "int64",
          "description": "Current page id"
        },
        "limit": {
          "type": "integer",
          "format": "int64",
          "description": "Current page size"
        }
      },
      "title": "分页元数据"
    },
    "v1VersionResponse": {
      "type": "object",
      "properties": {
        "version": {
          "type": "string",
          "description": "版本号"
        }
      }
    }
  },
  "securityDefinitions": {
    "AppId": {
      "type": "apiKey",
      "name": "X-App-Id",
      "in": "header"
    },
    "BearerToken": {
      "type": "apiKey",
      "name": "Authorization",
      "in": "header"
    }
  }
}
